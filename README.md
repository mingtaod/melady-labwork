# melady-labwork
# Summary of lab works in Melady Lab @ USC

### Instructions on running the experiments for the conference:

1. (This step can be skipped if you already have the model weight files.) Run the file burn_resnet50.py as the main k-fold validation training script and obtain the 5 model weights as well as training summaries. Note: you should change the directories in this script accordingly. For instance, on line 525 you would probably want to change the absolute path "D:\\torch-model-weights\\burnCNN_imagewise_weights\\burnCNN_fold" to the local machine path in which you would like to save the model weights. Please pay attention to other places where paths are used. In this step, when the model training is finished, we already get the specific results of models' performance in the general classification task.

2. Open the file predict.py. To illustrate, this file is written for getting the names of the images in the train dataset that are classified correctly so that we can obtain the burn depth classification results with the help of step3. After getting the model weights, please pick the weight you would like to use and pass its path into the function call at line 76. By this step we load the model weight and get the trained model. Then, change the directories in this file accordingly like we did in step1. Then run the program. The image names that are classified correctly will be displayed in the console. Copy them into the two files train_right.txt and valid_right.txt accordingly (I will optimize and make it automatic later on). Note: the two files valid.txt and train.txt contain the image names in validation (test) dataset and training dataset respectively. 

3. Open the file script.py. This file calculates the burn depth classification results using the patient information excel file in the repo as well as the train_right.txt file produced in step2. To run this program, you need to first change the directories in the code accordingly as in step2 and step3. After changing the directories, directly run the program and the results will be written into the console. Train accuracy for burn depth category 1 through 4 will be displayed in the console. 
